{% extends "base.html" %}
{% load time_filters %}
{% block title %}{{album.title}}{% endblock title %}

{% block content %}
<div class="album-detail">
  <div class="album-meta">
    <img src="{{album.images.0.url}}" alt="{{album.name}}">
    <h1>{{album.name}}</h1>
    <h4>{{album.artists.0.name}}</h4>
  </div>

  <form action="{%url 'LikeASong' %}" method="POST">
    {% csrf_token %}
    <div class="track-list">
      {% for track in album.tracks.items %}
      <div class="track-row">

        <p class="track-title">{{track.track_number}}. {{track.name}}</p>

        <button value="{{track.id}}" name="song_id" class='primary-btn icon-btn'><i class="material-icons">favorite</i></button>
        <p class="track-duration">{{track.duration_ms|ms_to_mins}}</p>
      </div>

      {% endfor %}
    </div>
  </form>
</div>

<div class="reviews-section">

  <div class="reviews-header">
    <h1>Thoughts</h1>

    {%if user.is_authenticated%}
    <a href="{% url 'create-review' album.id %}" class="primary-btn icon-btn">
      <i class="material-icons">add</i>
    </a>
  </div>

  <div class="reviews-grid">
    {% for review in reviews %}
<div class="review-card">

  <div class="review-top">
    <p class="review-user">{{ review.user }}</p>

    <div class="review-actions">
      <span class="review-rating">{{ review.rating }}/5</span>

      <a href="{% url 'deleteReview' album.id 'detail' review.id %}"
         class="delete-review"
         aria-label="Delete review">
        <i class="material-icons">delete</i>
      </a>
    </div>
  </div>

  <p class="review-content">{{ review.content }}</p>

  <div class="review-tracks">
    <p><strong>Favourite:</strong> {{ review.fav }}</p>
    <p><strong>Honourable mention:</strong> {{ review.mention }}</p>
    <p><strong>Least:</strong> {{ review.least }}</p>
  </div>

</div>

    {% endfor %}
  </div>

  {%else%}
  <h1>login to view reviews</h1>
  {%endif%}
</div>

{% endblock content %}
